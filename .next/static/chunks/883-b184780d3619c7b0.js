"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{59883:function(e,t,n){n.d(t,{default:function(){return w}});var r=n(57437),a=n(2265),s=n(99376),i=n(27648),o=n(96215),l=n(44794),c=n(95805),d=n(20395),u=n(41473),f=n(48713),m=n(86595),h=n(29857),p=n(98728),x=n(32489),g=n(58293),v=n(47692),b=n(62869),N=n(18730),y=n(16831),j=n(84190);function w(e){let{children:t}=e,[n,w]=(0,a.useState)(!1),z=(0,s.usePathname)(),{user:k,logout:F}=(0,N.a)();(0,a.useEffect)(()=>{w(!1)},[z]);let _=[{href:"/dashboard",label:"Dashboard",icon:o.Z},{href:"/items",label:"Items",icon:l.Z},{href:"/users",label:"Users",icon:c.Z},{href:"/weapons",label:"Weapons",icon:d.Z},{href:"/categories",label:"Categories",icon:u.Z},{href:"/collections",label:"Collections",icon:f.Z},{href:"/rarities",label:"Rarities",icon:m.Z},{href:"/types",label:"Types",icon:h.Z},{href:"/settings",label:"Settings",icon:p.Z}],Z=()=>k&&k.username?k.username.charAt(0).toUpperCase():"U";return(0,r.jsxs)("div",{className:"min-h-screen bg-zinc-950 text-zinc-100",children:[(0,r.jsx)("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:(0,r.jsx)(b.z,{variant:"outline",size:"icon",onClick:()=>w(!n),className:"bg-zinc-900 border-zinc-800 hover:bg-zinc-800 hover:text-zinc-100",children:n?(0,r.jsx)(x.Z,{size:20}):(0,r.jsx)(g.Z,{size:20})})}),(0,r.jsxs)("aside",{className:"\n        fixed top-0 left-0 z-40 h-full w-64 bg-zinc-900 border-r border-zinc-800 transition-transform\n        ".concat(n?"translate-x-0":"-translate-x-full"," lg:translate-x-0\n      "),children:[(0,r.jsx)("div",{className:"p-4 border-b border-zinc-800 flex items-center justify-between",children:(0,r.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,r.jsx)(l.Z,{className:"h-6 w-6"}),"Admin Dashboard"]})}),k&&(0,r.jsx)("div",{className:"p-4 border-b border-zinc-800",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(y.qE,{children:[(0,r.jsx)(y.F$,{src:k.avatar||"/placeholder.svg",alt:k.username}),(0,r.jsx)(y.Q5,{className:"bg-zinc-700",children:Z()})]}),(0,r.jsxs)("div",{className:"overflow-hidden",children:[(0,r.jsx)("p",{className:"font-medium truncate",children:k.username}),(0,r.jsx)("p",{className:"text-xs text-zinc-400 truncate",children:k.email})]})]})}),(0,r.jsx)("nav",{className:"p-4 space-y-1",children:_.map(e=>{let t=z===e.href;return(0,r.jsxs)(i.default,{href:e.href,className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(t?"bg-zinc-800 text-zinc-100":"text-zinc-400 hover:bg-zinc-800 hover:text-zinc-100"),children:[(0,r.jsx)(e.icon,{size:20}),e.label]},e.href)})}),(0,r.jsx)("div",{className:"absolute bottom-0 w-full p-4 border-t border-zinc-800",children:(0,r.jsxs)(b.z,{onClick:F,variant:"ghost",className:"w-full flex items-center gap-3 px-3 py-2 rounded-md text-zinc-400 hover:bg-zinc-800 hover:text-zinc-100 justify-start",children:[(0,r.jsx)(v.Z,{size:20}),"Logout"]})})]}),(0,r.jsx)("div",{className:"lg:hidden fixed top-0 left-0 right-0 h-16 bg-zinc-900 border-b border-zinc-800 z-30 flex items-center justify-end px-4",children:k&&(0,r.jsxs)(j.h_,{children:[(0,r.jsx)(j.$F,{asChild:!0,children:(0,r.jsx)(b.z,{variant:"ghost",className:"h-8 w-8 rounded-full",size:"icon",children:(0,r.jsxs)(y.qE,{className:"h-8 w-8",children:[(0,r.jsx)(y.F$,{src:k.avatar||"/placeholder.svg",alt:k.username}),(0,r.jsx)(y.Q5,{className:"bg-zinc-700",children:Z()})]})})}),(0,r.jsxs)(j.AW,{align:"end",className:"bg-zinc-900 border-zinc-800",children:[(0,r.jsx)(j.Ju,{children:(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:k.username}),(0,r.jsx)("p",{className:"text-xs text-zinc-400",children:k.email})]})}),(0,r.jsx)(j.VD,{className:"bg-zinc-800"}),(0,r.jsxs)(j.Xi,{className:"text-zinc-300 hover:text-zinc-100 focus:text-zinc-100 focus:bg-zinc-800 cursor-pointer",onClick:F,children:[(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4"}),(0,r.jsx)("span",{children:"Выйти"})]})]})]})}),(0,r.jsx)("main",{className:"lg:ml-64 p-6 pt-20 lg:pt-6",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto",children:t})})]})}},16831:function(e,t,n){n.d(t,{F$:function(){return l},Q5:function(){return c},qE:function(){return o}});var r=n(57437),a=n(2265),s=n(70650),i=n(94508);let o=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.fC,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",n),...a})});o.displayName=s.fC.displayName;let l=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.Ee,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",n),...a})});l.displayName=s.Ee.displayName;let c=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.NY,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",n),...a})});c.displayName=s.NY.displayName},62869:function(e,t,n){n.d(t,{d:function(){return l},z:function(){return c}});var r=n(57437),a=n(2265),s=n(37053),i=n(90535),o=n(94508);let l=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:n,variant:a,size:i,asChild:c=!1,...d}=e,u=c?s.g7:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:n})),ref:t,...d})});c.displayName="Button"},84190:function(e,t,n){n.d(t,{$F:function(){return u},AW:function(){return f},Ju:function(){return p},VD:function(){return x},Xi:function(){return m},bO:function(){return h},h_:function(){return d}});var r=n(57437),a=n(2265),s=n(66192),i=n(10407),o=n(30401),l=n(40519),c=n(94508);let d=s.fC,u=s.xz;s.ZA,s.Uv,s.Tr,s.Ee,a.forwardRef((e,t)=>{let{className:n,inset:a,children:o,...l}=e;return(0,r.jsxs)(s.fF,{ref:t,className:(0,c.cn)("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",n),...l,children:[o,(0,r.jsx)(i.Z,{className:"ml-auto"})]})}).displayName=s.fF.displayName,a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.tu,{ref:t,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...a})}).displayName=s.tu.displayName;let f=a.forwardRef((e,t)=>{let{className:n,sideOffset:a=4,...i}=e;return(0,r.jsx)(s.Uv,{children:(0,r.jsx)(s.VY,{ref:t,sideOffset:a,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n),...i})})});f.displayName=s.VY.displayName;let m=a.forwardRef((e,t)=>{let{className:n,inset:a,...i}=e;return(0,r.jsx)(s.ck,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",n),...i})});m.displayName=s.ck.displayName;let h=a.forwardRef((e,t)=>{let{className:n,children:a,checked:i,...l}=e;return(0,r.jsxs)(s.oC,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),checked:i,...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.wU,{children:(0,r.jsx)(o.Z,{className:"h-4 w-4"})})}),a]})});h.displayName=s.oC.displayName,a.forwardRef((e,t)=>{let{className:n,children:a,...i}=e;return(0,r.jsxs)(s.Rk,{ref:t,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(s.wU,{children:(0,r.jsx)(l.Z,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=s.Rk.displayName;let p=a.forwardRef((e,t)=>{let{className:n,inset:a,...i}=e;return(0,r.jsx)(s.__,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",n),...i})});p.displayName=s.__.displayName;let x=a.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,r.jsx)(s.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",n),...a})});x.displayName=s.Z0.displayName},18730:function(e,t,n){n.d(t,{AuthProvider:function(){return c},a:function(){return d}});var r=n(57437),a=n(2265),s=n(99376),i=n(16023),o=n(8530);let l=(0,a.createContext)(void 0),c=e=>{let{children:t}=e,[n,c]=(0,a.useState)(null),[d,u]=(0,a.useState)(!0),[f,m]=(0,a.useState)(null),h=(0,s.useRouter)(),p=(0,s.usePathname)();(0,a.useEffect)(()=>{if(!o.FD.requireAuth){u(!1);return}(async()=>{u(!0);try{if((0,i.$8)()){let e=await (0,i.ts)();e?(c(e),(0,i.Ft)(e.role)||(null==p?void 0:p.includes("/forbidden"))||(null==p?void 0:p.includes("/login"))||(null==p?void 0:p.includes("/auth/callback"))||h.push(o.FD.forbiddenPage)):((0,i.gy)(),(null==p?void 0:p.includes("/login"))||(null==p?void 0:p.includes("/auth/callback"))||(null==p?void 0:p.includes("/forbidden"))||h.push(o.FD.loginPage))}else(null==p?void 0:p.includes("/login"))||(null==p?void 0:p.includes("/auth/callback"))||(null==p?void 0:p.includes("/forbidden"))||h.push(o.FD.loginPage)}catch(e){m("Ошибка при проверке аутентификации"),console.error("Auth check error:",e)}finally{u(!1)}})()},[p,h]);let x=async()=>{if(o.FD.requireAuth){u(!0);try{let e=await (0,i.ts)();e?c(e):((0,i.gy)(),h.push(o.FD.loginPage))}catch(e){m("Ошибка при обновлении данных пользователя"),console.error("User refresh error:",e)}finally{u(!1)}}},g=!!n&&(0,i.Ft)(n.role);return(0,r.jsx)(l.Provider,{value:{user:n,isAuthenticated:!o.FD.requireAuth||!!n,isLoading:d,error:f,login:()=>{window.location.href=o.Pn.googleLogin},logout:()=>{(0,i.gy)(),c(null),h.push(o.FD.loginPage)},refreshUser:x,hasPermission:g},children:t})},d=()=>{let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},16023:function(e,t,n){n.d(t,{$8:function(){return l},Ft:function(){return c},gy:function(){return o},p$:function(){return u},ts:function(){return d}});var r=n(8530);let a=!1,s=e=>{localStorage.setItem(r.nd,e)},i=()=>localStorage.getItem(r.nd),o=()=>{localStorage.removeItem(r.nd)},l=()=>!r.FD.requireAuth||!!i(),c=e=>!r.FD.requireAuth||!!e&&r.FD.allowedRoles.includes(e),d=async()=>{if(!r.FD.requireAuth)return null;let e=i();if(!e)return null;try{let t=await fetch(r.Pn.me,{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)return 401===t.status&&o(),null;return await t.json()}catch(e){return console.error("Error fetching user data:",e),null}},u=async e=>{if(a)return null;try{a=!0;let t=await fetch("".concat(r.Pn.googleCallback,"?code=").concat(e),{method:"GET"});if(!t.ok){let e=await t.text();throw Error(400===t.status?"Код авторизации недействителен или уже использован":"Не удалось обменять код: ".concat(t.status," ").concat(e))}let n=await t.json(),i=n.token;if(!i)throw Error("Токен не получен");return s(i),{user:n,token:i}}catch(e){throw e}finally{a=!1}}},8530:function(e,t,n){n.d(t,{CT:function(){return r},FD:function(){return l},Pn:function(){return a},f_:function(){return s},g8:function(){return i},nd:function(){return o}});let r="https://api.standoff.uz",a={items:"".concat(r,"/admin/api/v1/items"),weapons:"".concat(r,"/admin/api/v1/weapons"),categories:"".concat(r,"/admin/api/v1/categories"),collections:"".concat(r,"/admin/api/v1/collections"),rarities:"".concat(r,"/admin/api/v1/rarities"),types:"".concat(r,"/admin/api/v1/types"),upload:"".concat(r,"/admin/api/v1/upload"),serverStats:"".concat(r,"/admin/api/v1/get-server-stats"),googleLogin:"".concat(r,"/auth/google/login"),googleCallback:"".concat(r,"/auth/google/callback"),me:"".concat(r,"/auth/google/me")},s=r,i="",o="admin_auth_token";"".concat(window.location.protocol,"//").concat(window.location.host);let l={requireAuth:!0,allowedRoles:["admin","moderator"],loginPage:"/login",forbiddenPage:"/forbidden"}},94508:function(e,t,n){n.d(t,{cn:function(){return s}});var r=n(61994),a=n(53335);function s(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,a.m6)((0,r.W)(t))}}}]);