(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[488],{3095:function(e,r,a){Promise.resolve().then(a.bind(a,41123))},41123:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return N}});var n=a(57437),t=a(2265),s=a(59883),i=a(62869),c=a(95186),l=a(73247),o=a(99397),d=a(15868),m=a(18930),u=a(73578),x=a(35974),h=a(26110),f=a(98339),b=a(71264),j=a(77992);let p=[{id:1,name:"Common",color:"#d3d3d3"},{id:2,name:"Uncommon",color:"#add8e6"},{id:3,name:"Rare",color:"#87ceeb"},{id:4,name:"Epic",color:"#9370db"},{id:5,name:"Legendary",color:"#ff69b4"}],g=e=>{switch(e.toLowerCase()){case"common":return"#d3d3d3";case"uncommon":return"#add8e6";case"rare":return"#87ceeb";case"epic":return"#9370db";case"legendary":return"#ff69b4";case"arcane":return"#ff4500";case"nameless":return"#b8860b";default:return"#808080"}};function N(){let{toast:e}=(0,j.pm)(),[r,a]=(0,t.useState)([]),[N,v]=(0,t.useState)(!0),[y,z]=(0,t.useState)(""),[w,C]=(0,t.useState)(!1),[S,E]=(0,t.useState)(!1),[k,R]=(0,t.useState)(!1),[Z,T]=(0,t.useState)(!1),[q,O]=(0,t.useState)(null),A=async()=>{try{v(!0),C(!1);let e=await fetch("/api/rarities",{cache:"no-store"});if(!e.ok)throw Error("API Error: ".concat(e.status));let r=(await e.json()).map(e=>({...e,color:e.color||g(e.name)}));a(r)}catch(r){console.error("Error fetching rarities:",r),a(p),C(!0),e({title:"Внимание",description:"Используются демо-данные для предпросмотра.",variant:"destructive"})}finally{v(!1)}};(0,t.useEffect)(()=>{A()},[]);let _=r.filter(e=>e.name.toLowerCase().includes(y.toLowerCase()));return(0,n.jsxs)(s.default,{children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Rarities"}),(0,n.jsx)("p",{className:"text-zinc-400",children:"Manage item rarity levels"})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(l.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-zinc-500"}),(0,n.jsx)(c.I,{type:"search",placeholder:"Search rarities...",className:"pl-8 bg-zinc-900 border-zinc-800 focus-visible:ring-zinc-700",value:y,onChange:e=>z(e.target.value)})]}),(0,n.jsxs)(i.z,{className:"bg-zinc-800 hover:bg-zinc-700",onClick:()=>E(!0),children:[(0,n.jsx)(o.Z,{size:18,className:"mr-2"}),"Add Rarity"]})]})]}),N&&(0,n.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-zinc-400"})}),w&&!N&&(0,n.jsxs)("div",{className:"bg-amber-900/20 border border-amber-800 text-amber-300 p-4 rounded-lg mb-6",children:[(0,n.jsx)("p",{children:"Используются демо-данные для предпросмотра."}),(0,n.jsx)("p",{className:"mt-2 text-sm",children:"В рабочей версии приложения данные будут загружаться с вашего API."})]}),!N&&(0,n.jsxs)(n.Fragment,{children:[y&&(0,n.jsxs)("p",{className:"mb-4 text-zinc-400",children:["Найдено результатов: ",_.length]}),(0,n.jsx)("div",{className:"rounded-md border border-zinc-800 overflow-hidden",children:(0,n.jsxs)(u.iA,{children:[(0,n.jsx)(u.xD,{className:"bg-zinc-900",children:(0,n.jsxs)(u.SC,{className:"hover:bg-zinc-900/80 border-zinc-800",children:[(0,n.jsx)(u.ss,{className:"text-zinc-400",children:"ID"}),(0,n.jsx)(u.ss,{className:"text-zinc-400",children:"Name"}),(0,n.jsx)(u.ss,{className:"text-zinc-400",children:"Color"}),(0,n.jsx)(u.ss,{className:"text-zinc-400 text-right",children:"Actions"})]})}),(0,n.jsx)(u.RM,{children:_.length>0?_.map(e=>(0,n.jsxs)(u.SC,{className:"hover:bg-zinc-900/50 border-zinc-800",children:[(0,n.jsx)(u.pj,{children:e.id}),(0,n.jsx)(u.pj,{className:"font-medium",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),e.name]})}),(0,n.jsx)(u.pj,{children:(0,n.jsx)(x.C,{variant:"outline",className:"font-mono bg-zinc-900 border-zinc-700",children:e.color})}),(0,n.jsx)(u.pj,{className:"text-right",children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>{O(e),R(!0)},className:"h-8 w-8 text-zinc-400 hover:text-zinc-100",children:(0,n.jsx)(d.Z,{size:16})}),(0,n.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>{O(e),T(!0)},className:"h-8 w-8 text-red-400 hover:text-red-300",children:(0,n.jsx)(m.Z,{size:16})})]})})]},e.id)):(0,n.jsx)(u.SC,{children:(0,n.jsx)(u.pj,{colSpan:4,className:"h-24 text-center",children:y?"Ничего не найдено по вашему запросу":"Редкости не найдены"})})})]})})]}),(0,n.jsx)(h.Vq,{open:S,onOpenChange:E,children:(0,n.jsxs)(h.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-2xl",children:[(0,n.jsx)(h.fK,{children:(0,n.jsx)(h.$N,{children:"Добавить новую редкость"})}),(0,n.jsx)(f.Z,{endpoint:"/api/rarities",entityName:"Редкость",fields:[{name:"name",label:"Название",type:"text",required:!0},{name:"color",label:"Цвет",type:"color",required:!0,defaultValue:"#808080"}],onSuccess:()=>{E(!1),A()},onCancel:()=>E(!1)})]})}),(0,n.jsx)(h.Vq,{open:k,onOpenChange:R,children:(0,n.jsxs)(h.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-2xl",children:[(0,n.jsx)(h.fK,{children:(0,n.jsx)(h.$N,{children:"Редактировать редкость"})}),q&&(0,n.jsx)(f.Z,{endpoint:"/api/rarities",entityName:"Редкость",initialData:q,fields:[{name:"name",label:"Название",type:"text",required:!0},{name:"color",label:"Цвет",type:"color",required:!0}],onSuccess:()=>{R(!1),A()},onCancel:()=>R(!1)})]})}),q&&(0,n.jsx)(b.Z,{isOpen:Z,onClose:()=>T(!1),onConfirm:()=>{T(!1),A()},endpoint:"/api/rarities",id:q.id,entityName:"редкость",entityLabel:q.name})]})}},71264:function(e,r,a){"use strict";a.d(r,{Z:function(){return l}});var n=a(57437),t=a(2265),s=a(37099),i=a(77992),c=a(51817);function l(e){let{isOpen:r,onClose:a,onConfirm:l,endpoint:o,id:d,entityName:m,entityLabel:u}=e,[x,h]=(0,t.useState)(!1),f=async()=>{h(!0);try{if(!(await fetch("".concat(o,"/").concat(d),{method:"DELETE"})).ok)throw Error("Ошибка при удалении ".concat(m));(0,i.Am)({title:"Успешно",description:"".concat(u," был удален")}),l()}catch(e){console.error("Error deleting ".concat(m,":"),e),(0,i.Am)({title:"Ошибка",description:"Не удалось удалить ".concat(m),variant:"destructive"}),a()}finally{h(!1)}};return(0,n.jsx)(s.aR,{open:r,onOpenChange:a,children:(0,n.jsxs)(s._T,{className:"bg-zinc-900 border-zinc-800",children:[(0,n.jsxs)(s.fY,{children:[(0,n.jsx)(s.f$,{children:"Вы уверены?"}),(0,n.jsxs)(s.yT,{className:"text-zinc-400",children:["Вы собираетесь удалить ",m,' "',u,'". Это действие нельзя отменить.']})]}),(0,n.jsxs)(s.xo,{children:[(0,n.jsx)(s.le,{className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700 text-zinc-300",disabled:x,children:"Отмена"}),(0,n.jsx)(s.OL,{onClick:e=>{e.preventDefault(),f()},className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",disabled:x,children:x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Удаление..."]}):"Удалить"})]})]})})}},98339:function(e,r,a){"use strict";a.d(r,{Z:function(){return x}});var n=a(57437),t=a(2265),s=a(62869),i=a(95186),c=a(26815),l=a(77992),o=a(49322),d=a(51817),m=a(53647),u=a(65613);function x(e){let{endpoint:r,entityName:a,initialData:x,fields:h,onSuccess:f,onCancel:b}=e,j=!!(null==x?void 0:x.id),[p,g]=(0,t.useState)(!1),[N,v]=(0,t.useState)(null),[y,z]=(0,t.useState)(()=>{let e={};return h.forEach(r=>{x&&void 0!==x[r.name]?e[r.name]=x[r.name]:void 0!==r.defaultValue?e[r.name]=r.defaultValue:(r.type,e[r.name]="")}),e}),w=(e,r)=>{z(a=>({...a,[e]:r})),v(null)},C=async e=>{e.preventDefault(),g(!0),v(null);try{let e={...y};h.forEach(r=>{"select"===r.type&&e[r.name]&&(e[r.name]=Number(e[r.name]))});let n=j?"".concat(r,"/").concat(x.id):r,t=await fetch(n,{method:j?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),s=await t.json();if(!t.ok){if(400===t.status||422===t.status){let e=s.error||s.message||s.detail||"Неверные данные",r="";throw s.details&&(r="object"==typeof s.details?JSON.stringify(s.details,null,2):s.details),Error("".concat(e).concat(r?"\n".concat(r):""))}throw Error(s.error||"Произошла ошибка при сохранении")}(0,l.Am)({title:"Успешно",description:j?"".concat(a," обновлен"):"".concat(a," создан")}),f()}catch(e){console.error("Error saving ".concat(a,":"),e),v(e instanceof Error?e.message:"Произошла ошибка при сохранении")}finally{g(!1)}};return(0,n.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[N&&(0,n.jsxs)(u.bZ,{variant:"destructive",className:"bg-red-900/20 border-red-800 text-red-300",children:[(0,n.jsx)(o.Z,{className:"h-4 w-4"}),(0,n.jsx)(u.X,{className:"whitespace-pre-wrap",children:N})]}),h.map(e=>(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(c.Label,{htmlFor:e.name,children:e.label}),"text"===e.type&&(0,n.jsx)(i.I,{id:e.name,value:y[e.name]||"",onChange:r=>w(e.name,r.target.value),className:"bg-zinc-800 border-zinc-700",required:e.required}),"color"===e.type&&(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(i.I,{id:e.name,type:"color",value:y[e.name]||"#000000",onChange:r=>w(e.name,r.target.value),className:"w-16 p-1 h-10 bg-zinc-800 border-zinc-700",required:e.required}),(0,n.jsx)(i.I,{value:y[e.name]||"",onChange:r=>w(e.name,r.target.value),className:"flex-1 font-mono bg-zinc-800 border-zinc-700",placeholder:"#000000"})]}),"select"===e.type&&e.options&&(0,n.jsxs)(m.Ph,{value:String(y[e.name]||""),onValueChange:r=>w(e.name,r?Number(r):""),children:[(0,n.jsx)(m.i4,{className:"bg-zinc-800 border-zinc-700",children:(0,n.jsx)(m.ki,{placeholder:"Не выбрано"})}),(0,n.jsx)(m.Bw,{className:"bg-zinc-900 border-zinc-700",children:e.options.map(e=>(0,n.jsx)(m.Ql,{value:String(e.id),children:e.name},e.id))})]})]},e.name)),(0,n.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,n.jsx)(s.z,{type:"button",variant:"outline",onClick:b,className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700",children:"Отмена"}),(0,n.jsxs)(s.z,{type:"submit",disabled:p,className:"bg-zinc-700 hover:bg-zinc-600",children:[p&&(0,n.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Сохранить":"Создать"]})]})]})}},35974:function(e,r,a){"use strict";a.d(r,{C:function(){return c}});var n=a(57437);a(2265);var t=a(90535),s=a(94508);let i=(0,t.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:r,variant:a,...t}=e;return(0,n.jsx)("div",{className:(0,s.cn)(i({variant:a}),r),...t})}},73578:function(e,r,a){"use strict";a.d(r,{RM:function(){return l},SC:function(){return o},iA:function(){return i},pj:function(){return m},ss:function(){return d},xD:function(){return c}});var n=a(57437),t=a(2265),s=a(94508);let i=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("div",{className:"relative w-full overflow-auto",children:(0,n.jsx)("table",{ref:r,className:(0,s.cn)("w-full caption-bottom text-sm",a),...t})})});i.displayName="Table";let c=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("thead",{ref:r,className:(0,s.cn)("[&_tr]:border-b",a),...t})});c.displayName="TableHeader";let l=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("tbody",{ref:r,className:(0,s.cn)("[&_tr:last-child]:border-0",a),...t})});l.displayName="TableBody",t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("tfoot",{ref:r,className:(0,s.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...t})}).displayName="TableFooter";let o=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("tr",{ref:r,className:(0,s.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...t})});o.displayName="TableRow";let d=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("th",{ref:r,className:(0,s.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...t})});d.displayName="TableHead";let m=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("td",{ref:r,className:(0,s.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...t})});m.displayName="TableCell",t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,n.jsx)("caption",{ref:r,className:(0,s.cn)("mt-4 text-sm text-muted-foreground",a),...t})}).displayName="TableCaption"}},function(e){e.O(0,[441,681,582,447,624,263,883,886,971,117,744],function(){return e(e.s=3095)}),_N_E=e.O()}]);