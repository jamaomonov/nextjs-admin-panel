(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[748],{36343:function(e,a,s){Promise.resolve().then(s.bind(s,79566))},79566:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return R}});var r=s(57437),n=s(2265),i=s(59883),t=s(62869),l=s(95186),c=s(73247),o=s(99397),d=s(42208),m=s(15868),h=s(18930),x=s(73578),u=s(35974),g=s(26110),f=s(71264),p=s(77992),j=s(26815),b=s(53647),v=s(51817),N=s(49322),y=s(65613),_=s(12339),z=s(66070),w=s(99376);function C(e){var a,s,i,c,o,d,m,h,x,u,g,f,C,S,L,T,E,I,R,k;let{initialData:F,onSuccess:Z,onCancel:O}=e,A=(0,w.useRouter)(),P=!!(null==F?void 0:F.id),[D,V]=(0,n.useState)(!1),[Y,$]=(0,n.useState)(null),[K,q]=(0,n.useState)({name:(null==F?void 0:F.name)||"",type_id:(null==F?void 0:F.type_id)||"",damage:(null==F?void 0:F.damage)||"0",fire_rate:(null==F?void 0:F.fire_rate)||"0",recoil:(null==F?void 0:F.recoil)||"0",range:(null==F?void 0:F.range)||"0",mobility:(null==F?void 0:F.mobility)||"0",armor_penetration:(null==F?void 0:F.armor_penetration)||"0",penetration_power:(null==F?void 0:F.penetration_power)||"0",ammo:(null==F?void 0:F.ammo)||"0",cost:(null==F?void 0:F.cost)||"0",damage_info:{armor:{arms:(null==F?void 0:null===(s=F.damage_info)||void 0===s?void 0:null===(a=s.armor)||void 0===a?void 0:a.arms)||"0",chest:(null==F?void 0:null===(c=F.damage_info)||void 0===c?void 0:null===(i=c.armor)||void 0===i?void 0:i.chest)||"0",head:(null==F?void 0:null===(d=F.damage_info)||void 0===d?void 0:null===(o=d.armor)||void 0===o?void 0:o.head)||"0",legs:(null==F?void 0:null===(h=F.damage_info)||void 0===h?void 0:null===(m=h.armor)||void 0===m?void 0:m.legs)||"0",stomach:(null==F?void 0:null===(u=F.damage_info)||void 0===u?void 0:null===(x=u.armor)||void 0===x?void 0:x.stomach)||"0"},no_armor:{arms:(null==F?void 0:null===(f=F.damage_info)||void 0===f?void 0:null===(g=f.no_armor)||void 0===g?void 0:g.arms)||"0",chest:(null==F?void 0:null===(S=F.damage_info)||void 0===S?void 0:null===(C=S.no_armor)||void 0===C?void 0:C.chest)||"0",head:(null==F?void 0:null===(T=F.damage_info)||void 0===T?void 0:null===(L=T.no_armor)||void 0===L?void 0:L.head)||"0",legs:(null==F?void 0:null===(I=F.damage_info)||void 0===I?void 0:null===(E=I.no_armor)||void 0===E?void 0:E.legs)||"0",stomach:(null==F?void 0:null===(k=F.damage_info)||void 0===k?void 0:null===(R=k.no_armor)||void 0===R?void 0:R.stomach)||"0"}}}),[M,W]=(0,n.useState)([]),[H,B]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{B(!0);try{let e=await fetch("/api/types",{next:{revalidate:60}});if(!e.ok)throw Error("API Error: ".concat(e.status));let a=await e.json();W(a)}catch(e){console.error("Error loading weapon types:",e),(0,p.Am)({title:"Ошибка",description:"Не удалось загрузить типы оружия",variant:"destructive"})}finally{B(!1)}})()},[]);let J=(e,a)=>{q(s=>({...s,[e]:a})),$(null)},U=(e,a,s)=>{q(r=>({...r,damage_info:{...r.damage_info,[e]:{...r.damage_info[e],[a]:s}}})),$(null)},X=async e=>{e.preventDefault(),V(!0),$(null);try{if(!K.name||!K.type_id)throw Error("Название и тип оружия обязательны для заполнения");let e={name:K.name,type_id:Number(K.type_id)};["damage","fire_rate","recoil","range","mobility","armor_penetration","penetration_power","ammo","cost"].forEach(a=>{""!==K[a]&&(e[a]=Number(K[a]))});let a=K.damage_info.armor,s=K.damage_info.no_armor,r=Object.values(a).some(e=>""!==e),n=Object.values(s).some(e=>""!==e);(r||n)&&(e.damage_info={},r&&(e.damage_info.armor={},Object.entries(a).forEach(a=>{let[s,r]=a;""!==r&&(e.damage_info.armor[s]=Number(r))})),n&&(e.damage_info.no_armor={},Object.entries(s).forEach(a=>{let[s,r]=a;""!==r&&(e.damage_info.no_armor[s]=Number(r))})));let i=P?"/api/weapons/".concat(F.id):"/api/weapons",t=await fetch(i,{method:P?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await t.json();if(!t.ok){if(400===t.status||422===t.status){let e=l.error||l.message||l.detail||"Неверные данные",a="";throw l.details&&(a="object"==typeof l.details?JSON.stringify(l.details,null,2):l.details),Error("".concat(e).concat(a?"\n".concat(a):""))}throw Error(l.error||"Произошла ошибка при сохранении")}(0,p.Am)({title:"Успешно",description:P?"Оружие обновлено":"Оружие создано"}),A.refresh(),Z()}catch(e){console.error("Error saving weapon:",e),$(e instanceof Error?e.message:"Произошла ошибка при сохранении")}finally{V(!1)}};return H?(0,r.jsxs)("div",{className:"flex justify-center items-center p-8",children:[(0,r.jsx)(v.Z,{className:"h-8 w-8 animate-spin text-zinc-400"}),(0,r.jsx)("span",{className:"ml-2 text-zinc-400",children:"Загрузка данных..."})]}):(0,r.jsxs)("form",{onSubmit:X,className:"space-y-6",children:[Y&&(0,r.jsxs)(y.bZ,{variant:"destructive",className:"bg-red-900/20 border-red-800 text-red-300",children:[(0,r.jsx)(N.Z,{className:"h-4 w-4"}),(0,r.jsx)(y.X,{className:"whitespace-pre-wrap",children:Y})]}),(0,r.jsxs)(_.Tabs,{defaultValue:"basic",className:"w-full",children:[(0,r.jsxs)(_.TabsList,{className:"bg-zinc-900 border border-zinc-800 mb-4",children:[(0,r.jsx)(_.TabsTrigger,{value:"basic",children:"Основное"}),(0,r.jsx)(_.TabsTrigger,{value:"stats",children:"Характеристики"}),(0,r.jsx)(_.TabsTrigger,{value:"damage",children:"Урон"})]}),(0,r.jsxs)(_.TabsContent,{value:"basic",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"name",children:"Название*"}),(0,r.jsx)(l.I,{id:"name",value:K.name,onChange:e=>J("name",e.target.value),placeholder:"Введите название оружия",className:"bg-zinc-800 border-zinc-700",required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"type",children:"Тип*"}),(0,r.jsxs)(b.Ph,{value:K.type_id?K.type_id.toString():"",onValueChange:e=>J("type_id",e?Number.parseInt(e):""),children:[(0,r.jsx)(b.i4,{className:"bg-zinc-800 border-zinc-700",children:(0,r.jsx)(b.ki,{placeholder:"Не выбрано"})}),(0,r.jsx)(b.Bw,{className:"bg-zinc-900 border-zinc-700",children:M.map(e=>(0,r.jsx)(b.Ql,{value:e.id.toString(),children:e.name},e.id))})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"cost",children:"Стоимость"}),(0,r.jsx)(l.I,{id:"cost",type:"number",value:K.cost,onChange:e=>J("cost",e.target.value),placeholder:"Стоимость оружия",className:"bg-zinc-800 border-zinc-700"})]})]}),(0,r.jsx)(_.TabsContent,{value:"stats",className:"space-y-4",children:(0,r.jsx)(z.Zb,{className:"bg-zinc-900 border-zinc-800",children:(0,r.jsx)(z.aY,{className:"pt-6 space-y-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"damage",children:"Урон"}),(0,r.jsx)(l.I,{id:"damage",type:"number",value:K.damage,onChange:e=>J("damage",e.target.value),placeholder:"Базовый урон",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"fire_rate",children:"Скорострельность"}),(0,r.jsx)(l.I,{id:"fire_rate",type:"number",value:K.fire_rate,onChange:e=>J("fire_rate",e.target.value),placeholder:"Выстрелов в минуту",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"recoil",children:"Отдача"}),(0,r.jsx)(l.I,{id:"recoil",type:"number",value:K.recoil,onChange:e=>J("recoil",e.target.value),placeholder:"Уровень отдачи",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"range",children:"Дальность"}),(0,r.jsx)(l.I,{id:"range",type:"number",value:K.range,onChange:e=>J("range",e.target.value),placeholder:"Эффективная дальность",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"mobility",children:"Мобильность"}),(0,r.jsx)(l.I,{id:"mobility",type:"number",value:K.mobility,onChange:e=>J("mobility",e.target.value),placeholder:"Скорость передвижения",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"ammo",children:"Боезапас"}),(0,r.jsx)(l.I,{id:"ammo",type:"number",value:K.ammo,onChange:e=>J("ammo",e.target.value),placeholder:"Количество патронов",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_penetration",children:"Пробитие брони"}),(0,r.jsx)(l.I,{id:"armor_penetration",type:"number",value:K.armor_penetration,onChange:e=>J("armor_penetration",e.target.value),placeholder:"Процент пробития брони",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"penetration_power",children:"Сила пробития"}),(0,r.jsx)(l.I,{id:"penetration_power",type:"number",value:K.penetration_power,onChange:e=>J("penetration_power",e.target.value),placeholder:"Сила пробития материалов",className:"bg-zinc-800 border-zinc-700"})]})]})})})}),(0,r.jsx)(_.TabsContent,{value:"damage",className:"space-y-4",children:(0,r.jsx)(z.Zb,{className:"bg-zinc-900 border-zinc-800",children:(0,r.jsxs)(z.aY,{className:"pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Урон по броне"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_head",children:"Голова"}),(0,r.jsx)(l.I,{id:"armor_head",type:"number",value:K.damage_info.armor.head,onChange:e=>U("armor","head",e.target.value),placeholder:"Урон в голову",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_chest",children:"Грудь"}),(0,r.jsx)(l.I,{id:"armor_chest",type:"number",value:K.damage_info.armor.chest,onChange:e=>U("armor","chest",e.target.value),placeholder:"Урон в грудь",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_stomach",children:"Живот"}),(0,r.jsx)(l.I,{id:"armor_stomach",type:"number",value:K.damage_info.armor.stomach,onChange:e=>U("armor","stomach",e.target.value),placeholder:"Урон в живот",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_arms",children:"Руки"}),(0,r.jsx)(l.I,{id:"armor_arms",type:"number",value:K.damage_info.armor.arms,onChange:e=>U("armor","arms",e.target.value),placeholder:"Урон в руки",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"armor_legs",children:"Ноги"}),(0,r.jsx)(l.I,{id:"armor_legs",type:"number",value:K.damage_info.armor.legs,onChange:e=>U("armor","legs",e.target.value),placeholder:"Урон в ноги",className:"bg-zinc-800 border-zinc-700"})]})]}),(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Урон без брони"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"no_armor_head",children:"Голова"}),(0,r.jsx)(l.I,{id:"no_armor_head",type:"number",value:K.damage_info.no_armor.head,onChange:e=>U("no_armor","head",e.target.value),placeholder:"Урон в голову",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"no_armor_chest",children:"Грудь"}),(0,r.jsx)(l.I,{id:"no_armor_chest",type:"number",value:K.damage_info.no_armor.chest,onChange:e=>U("no_armor","chest",e.target.value),placeholder:"Урон в грудь",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"no_armor_stomach",children:"Живот"}),(0,r.jsx)(l.I,{id:"no_armor_stomach",type:"number",value:K.damage_info.no_armor.stomach,onChange:e=>U("no_armor","stomach",e.target.value),placeholder:"Урон в живот",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"no_armor_arms",children:"Руки"}),(0,r.jsx)(l.I,{id:"no_armor_arms",type:"number",value:K.damage_info.no_armor.arms,onChange:e=>U("no_armor","arms",e.target.value),placeholder:"Урон в руки",className:"bg-zinc-800 border-zinc-700"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(j.Label,{htmlFor:"no_armor_legs",children:"Ноги"}),(0,r.jsx)(l.I,{id:"no_armor_legs",type:"number",value:K.damage_info.no_armor.legs,onChange:e=>U("no_armor","legs",e.target.value),placeholder:"Урон в ноги",className:"bg-zinc-800 border-zinc-700"})]})]})]})})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,r.jsx)(t.z,{type:"button",variant:"outline",onClick:O,className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700",children:"Отмена"}),(0,r.jsxs)(t.z,{type:"submit",disabled:D,className:"bg-zinc-700 hover:bg-zinc-600",children:[D&&(0,r.jsx)(v.Z,{className:"mr-2 h-4 w-4 animate-spin"}),P?"Сохранить":"Создать"]})]})]})}var S=s(77796),L=s(94508);let T=n.forwardRef((e,a)=>{let{className:s,value:n,indicatorClassName:i,...t}=e;return(0,r.jsx)(S.fC,{ref:a,className:(0,L.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...t,children:(0,r.jsx)(S.z$,{className:(0,L.cn)("h-full w-full flex-1 bg-primary transition-all",i),style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});function E(e){let{isOpen:a,onClose:s,weapon:n}=e,i={damage:100,fire_rate:1200,recoil:100,range:100,mobility:100,armor_penetration:100,penetration_power:100},t=function(e,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e/a*100;return s?r<30?"bg-green-500":r<60?"bg-yellow-500":"bg-red-500":r>70?"bg-green-500":r>40?"bg-yellow-500":"bg-red-500"};return(0,r.jsx)(g.Vq,{open:a,onOpenChange:s,children:(0,r.jsxs)(g.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-3xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)(g.fK,{children:(0,r.jsxs)(g.$N,{className:"text-2xl flex items-center gap-2",children:[n.name,n.type&&(0,r.jsx)(u.C,{variant:"outline",className:"ml-2 bg-zinc-800 text-zinc-300 border-zinc-700",children:n.type.name})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-400",children:"ID"}),(0,r.jsx)("div",{className:"font-medium",children:n.id})]}),(0,r.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-400",children:"Slug"}),(0,r.jsx)("div",{className:"font-medium",children:n.slug})]}),void 0!==n.cost&&(0,r.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-400",children:"Стоимость"}),(0,r.jsxs)("div",{className:"font-medium",children:["$",n.cost]})]}),void 0!==n.ammo&&(0,r.jsxs)("div",{className:"bg-zinc-800 p-3 rounded-md",children:[(0,r.jsx)("div",{className:"text-sm text-zinc-400",children:"Боезапас"}),(0,r.jsxs)("div",{className:"font-medium",children:[n.ammo," патр."]})]})]}),(0,r.jsx)(z.Zb,{className:"bg-zinc-800 border-zinc-700",children:(0,r.jsxs)(z.aY,{className:"pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Характеристики"}),(0,r.jsxs)("div",{className:"space-y-4",children:[void 0!==n.damage&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Урон"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:n.damage})]}),(0,r.jsx)(T,{value:n.damage/i.damage*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.damage,i.damage)})]}),void 0!==n.fire_rate&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Скорострельность"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[n.fire_rate," выстр/мин"]})]}),(0,r.jsx)(T,{value:n.fire_rate/i.fire_rate*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.fire_rate,i.fire_rate)})]}),void 0!==n.recoil&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Отдача"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:n.recoil})]}),(0,r.jsx)(T,{value:n.recoil/i.recoil*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.recoil,i.recoil,!0)})]}),void 0!==n.range&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Дальность"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[n.range," м"]})]}),(0,r.jsx)(T,{value:n.range/i.range*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.range,i.range)})]}),void 0!==n.mobility&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Мобильность"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:n.mobility})]}),(0,r.jsx)(T,{value:n.mobility/i.mobility*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.mobility,i.mobility)})]}),void 0!==n.armor_penetration&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Пробитие брони"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[n.armor_penetration,"%"]})]}),(0,r.jsx)(T,{value:n.armor_penetration/i.armor_penetration*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.armor_penetration,i.armor_penetration)})]}),void 0!==n.penetration_power&&(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Сила пробития"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:n.penetration_power})]}),(0,r.jsx)(T,{value:n.penetration_power/i.penetration_power*100,className:"h-2 bg-zinc-700",indicatorClassName:t(n.penetration_power,i.penetration_power)})]})]})]})}),n.damage_info&&(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.damage_info.armor&&Object.keys(n.damage_info.armor).length>0&&(0,r.jsx)(z.Zb,{className:"bg-zinc-800 border-zinc-700",children:(0,r.jsxs)(z.aY,{className:"pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Урон по броне"}),(0,r.jsxs)("div",{className:"space-y-3",children:[void 0!==n.damage_info.armor.head&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Голова"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.armor.head})]}),void 0!==n.damage_info.armor.chest&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Грудь"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.armor.chest})]}),void 0!==n.damage_info.armor.stomach&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Живот"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.armor.stomach})]}),void 0!==n.damage_info.armor.arms&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Руки"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.armor.arms})]}),void 0!==n.damage_info.armor.legs&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Ноги"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.armor.legs})]})]})]})}),n.damage_info.no_armor&&Object.keys(n.damage_info.no_armor).length>0&&(0,r.jsx)(z.Zb,{className:"bg-zinc-800 border-zinc-700",children:(0,r.jsxs)(z.aY,{className:"pt-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"У��он без брони"}),(0,r.jsxs)("div",{className:"space-y-3",children:[void 0!==n.damage_info.no_armor.head&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Голова"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.no_armor.head})]}),void 0!==n.damage_info.no_armor.chest&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Грудь"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.no_armor.chest})]}),void 0!==n.damage_info.no_armor.stomach&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Живот"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.no_armor.stomach})]}),void 0!==n.damage_info.no_armor.arms&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Руки"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.no_armor.arms})]}),void 0!==n.damage_info.no_armor.legs&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm text-zinc-400",children:"Ноги"}),(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-700 border-zinc-600",children:n.damage_info.no_armor.legs})]})]})]})})]})]})]})})}T.displayName=S.fC.displayName;let I=[{id:1,name:"AK-47",slug:"ak47",type_id:1,type:{name:"Rifle",id:1},damage:35,fire_rate:600,recoil:10,range:30,mobility:80,armor_penetration:50,penetration_power:80,ammo:30,cost:2700,damage_info:{armor:{arms:30,chest:40,head:75,legs:25,stomach:50},no_armor:{arms:40,chest:50,head:100,legs:30,stomach:60}}},{id:2,name:"M4A4",slug:"m4a4",type_id:1,type:{name:"Rifle",id:1}},{id:3,name:"AWP",slug:"awp",type_id:2,type:{name:"Sniper Rifle",id:2}},{id:4,name:"Desert Eagle",slug:"deagle",type_id:3,type:{name:"Pistol",id:3}},{id:5,name:"USP-S",slug:"usp",type_id:3,type:{name:"Pistol",id:3}},{id:6,name:"Knife",slug:"knife",type_id:4,type:{name:"Knife",id:4}}];function R(){let{toast:e}=(0,p.pm)(),[a,s]=(0,n.useState)([]),[j,b]=(0,n.useState)([]),[v,N]=(0,n.useState)(!0),[y,_]=(0,n.useState)(""),[z,w]=(0,n.useState)(!1),[S,L]=(0,n.useState)(!1),[T,R]=(0,n.useState)(!1),[k,F]=(0,n.useState)(!1),[Z,O]=(0,n.useState)(!1),[A,P]=(0,n.useState)(null),D=async()=>{try{let e=await fetch("/api/types",{cache:"no-store"});if(!e.ok)throw Error("API Error: ".concat(e.status));let a=await e.json();b(a)}catch(e){console.error("Error fetching types:",e)}},V=async()=>{try{N(!0),w(!1);let e=await fetch("/api/weapons",{cache:"no-store"});if(!e.ok)throw Error("API Error: ".concat(e.status));let a=await e.json();s(a)}catch(a){console.error("Error fetching weapons:",a),s(I),w(!0),e({title:"Внимание",description:"Используются демо-данные для предпросмотра.",variant:"destructive"})}finally{N(!1)}};(0,n.useEffect)(()=>{D(),V()},[]);let Y=a.filter(e=>{var a;return e.name.toLowerCase().includes(y.toLowerCase())||e.slug.toLowerCase().includes(y.toLowerCase())||(null===(a=e.type)||void 0===a?void 0:a.name)&&e.type.name.toLowerCase().includes(y.toLowerCase())});return(0,r.jsxs)(i.default,{children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Weapons"}),(0,r.jsx)("p",{className:"text-zinc-400",children:"Manage weapon types and characteristics"})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-zinc-500"}),(0,r.jsx)(l.I,{type:"search",placeholder:"Search weapons...",className:"pl-8 bg-zinc-900 border-zinc-800 focus-visible:ring-zinc-700",value:y,onChange:e=>_(e.target.value)})]}),(0,r.jsxs)(t.z,{className:"bg-zinc-800 hover:bg-zinc-700",onClick:()=>L(!0),children:[(0,r.jsx)(o.Z,{size:18,className:"mr-2"}),"Add Weapon"]})]})]}),v&&(0,r.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-zinc-400"})}),z&&!v&&(0,r.jsxs)("div",{className:"bg-amber-900/20 border border-amber-800 text-amber-300 p-4 rounded-lg mb-6",children:[(0,r.jsx)("p",{children:"Используются демо-данные для предпросмотра."}),(0,r.jsx)("p",{className:"mt-2 text-sm",children:"В рабочей версии приложения данные будут загружаться с вашего API."})]}),!v&&(0,r.jsxs)(r.Fragment,{children:[y&&(0,r.jsxs)("p",{className:"mb-4 text-zinc-400",children:["Найдено результатов: ",Y.length]}),(0,r.jsx)("div",{className:"rounded-md border border-zinc-800 overflow-hidden",children:(0,r.jsxs)(x.iA,{children:[(0,r.jsx)(x.xD,{className:"bg-zinc-900",children:(0,r.jsxs)(x.SC,{className:"hover:bg-zinc-900/80 border-zinc-800",children:[(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Name"}),(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Type"}),(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Damage"}),(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Fire Rate"}),(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Ammo"}),(0,r.jsx)(x.ss,{className:"text-zinc-400",children:"Cost"}),(0,r.jsx)(x.ss,{className:"text-zinc-400 text-right",children:"Actions"})]})}),(0,r.jsx)(x.RM,{children:Y.length>0?Y.map(e=>{var a;return(0,r.jsxs)(x.SC,{className:"hover:bg-zinc-900/50 border-zinc-800",children:[(0,r.jsx)(x.pj,{className:"font-medium",children:e.name}),(0,r.jsx)(x.pj,{children:(null===(a=e.type)||void 0===a?void 0:a.name)&&(0,r.jsx)(u.C,{variant:"outline",className:"bg-zinc-800 text-zinc-300 border-zinc-700",children:e.type.name})}),(0,r.jsx)(x.pj,{children:e.damage||"-"}),(0,r.jsx)(x.pj,{children:e.fire_rate||"-"}),(0,r.jsx)(x.pj,{children:e.ammo||"-"}),(0,r.jsx)(x.pj,{children:e.cost?"$".concat(e.cost):"-"}),(0,r.jsx)(x.pj,{className:"text-right",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)(t.z,{variant:"ghost",size:"icon",onClick:()=>{P(e),O(!0)},className:"h-8 w-8 text-zinc-400 hover:text-zinc-100",children:(0,r.jsx)(d.Z,{size:16})}),(0,r.jsx)(t.z,{variant:"ghost",size:"icon",onClick:()=>{P(e),R(!0)},className:"h-8 w-8 text-zinc-400 hover:text-zinc-100",children:(0,r.jsx)(m.Z,{size:16})}),(0,r.jsx)(t.z,{variant:"ghost",size:"icon",onClick:()=>{P(e),F(!0)},className:"h-8 w-8 text-red-400 hover:text-red-300",children:(0,r.jsx)(h.Z,{size:16})})]})})]},e.id)}):(0,r.jsx)(x.SC,{children:(0,r.jsx)(x.pj,{colSpan:7,className:"h-24 text-center",children:y?"Ничего не найдено по вашему запросу":"Оружие не найдено"})})})]})})]}),(0,r.jsx)(g.Vq,{open:S,onOpenChange:L,children:(0,r.jsxs)(g.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-4xl",children:[(0,r.jsx)(g.fK,{children:(0,r.jsx)(g.$N,{children:"Добавить новое оружие"})}),(0,r.jsx)(C,{onSuccess:()=>{L(!1),V()},onCancel:()=>L(!1)})]})}),(0,r.jsx)(g.Vq,{open:T,onOpenChange:R,children:(0,r.jsxs)(g.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-4xl",children:[(0,r.jsx)(g.fK,{children:(0,r.jsx)(g.$N,{children:"Редактировать оружие"})}),A&&(0,r.jsx)(C,{initialData:A,onSuccess:()=>{R(!1),V()},onCancel:()=>R(!1)})]})}),A&&(0,r.jsx)(E,{isOpen:Z,onClose:()=>O(!1),weapon:A}),A&&(0,r.jsx)(f.Z,{isOpen:k,onClose:()=>F(!1),onConfirm:()=>{F(!1),V()},endpoint:"/api/weapons",id:A.id,entityName:"оружие",entityLabel:A.name})]})}},71264:function(e,a,s){"use strict";s.d(a,{Z:function(){return c}});var r=s(57437),n=s(2265),i=s(37099),t=s(77992),l=s(51817);function c(e){let{isOpen:a,onClose:s,onConfirm:c,endpoint:o,id:d,entityName:m,entityLabel:h}=e,[x,u]=(0,n.useState)(!1),g=async()=>{u(!0);try{if(!(await fetch("".concat(o,"/").concat(d),{method:"DELETE"})).ok)throw Error("Ошибка при удалении ".concat(m));(0,t.Am)({title:"Успешно",description:"".concat(h," был удален")}),c()}catch(e){console.error("Error deleting ".concat(m,":"),e),(0,t.Am)({title:"Ошибка",description:"Не удалось удалить ".concat(m),variant:"destructive"}),s()}finally{u(!1)}};return(0,r.jsx)(i.aR,{open:a,onOpenChange:s,children:(0,r.jsxs)(i._T,{className:"bg-zinc-900 border-zinc-800",children:[(0,r.jsxs)(i.fY,{children:[(0,r.jsx)(i.f$,{children:"Вы уверены?"}),(0,r.jsxs)(i.yT,{className:"text-zinc-400",children:["Вы собираетесь удалить ",m,' "',h,'". Это действие нельзя отменить.']})]}),(0,r.jsxs)(i.xo,{children:[(0,r.jsx)(i.le,{className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700 text-zinc-300",disabled:x,children:"Отмена"}),(0,r.jsx)(i.OL,{onClick:e=>{e.preventDefault(),g()},className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",disabled:x,children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Удаление..."]}):"Удалить"})]})]})})}},35974:function(e,a,s){"use strict";s.d(a,{C:function(){return l}});var r=s(57437);s(2265);var n=s(90535),i=s(94508);let t=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:a,variant:s,...n}=e;return(0,r.jsx)("div",{className:(0,i.cn)(t({variant:s}),a),...n})}},66070:function(e,a,s){"use strict";s.d(a,{Ol:function(){return l},SZ:function(){return o},Zb:function(){return t},aY:function(){return d},eW:function(){return m},ll:function(){return c}});var r=s(57437),n=s(2265),i=s(94508);let t=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});t.displayName="Card";let l=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let c=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});c.displayName="CardTitle";let o=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",s),...n})});o.displayName="CardDescription";let d=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("p-6 pt-0",s),...n})});d.displayName="CardContent";let m=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",s),...n})});m.displayName="CardFooter"},73578:function(e,a,s){"use strict";s.d(a,{RM:function(){return c},SC:function(){return o},iA:function(){return t},pj:function(){return m},ss:function(){return d},xD:function(){return l}});var r=s(57437),n=s(2265),i=s(94508);let t=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,i.cn)("w-full caption-bottom text-sm",s),...n})})});t.displayName="Table";let l=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("thead",{ref:a,className:(0,i.cn)("[&_tr]:border-b",s),...n})});l.displayName="TableHeader";let c=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,i.cn)("[&_tr:last-child]:border-0",s),...n})});c.displayName="TableBody",n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,i.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...n})}).displayName="TableFooter";let o=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("tr",{ref:a,className:(0,i.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...n})});o.displayName="TableRow";let d=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("th",{ref:a,className:(0,i.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...n})});d.displayName="TableHead";let m=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("td",{ref:a,className:(0,i.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...n})});m.displayName="TableCell",n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)("caption",{ref:a,className:(0,i.cn)("mt-4 text-sm text-muted-foreground",s),...n})}).displayName="TableCaption"},12339:function(e,a,s){"use strict";s.d(a,{Tabs:function(){return l},TabsContent:function(){return d},TabsList:function(){return c},TabsTrigger:function(){return o}});var r=s(57437),n=s(2265),i=s(20271),t=s(94508);let l=i.fC,c=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)(i.aV,{ref:a,className:(0,t.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...n})});c.displayName=i.aV.displayName;let o=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)(i.xz,{ref:a,className:(0,t.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...n})});o.displayName=i.xz.displayName;let d=n.forwardRef((e,a)=>{let{className:s,...n}=e;return(0,r.jsx)(i.VY,{ref:a,className:(0,t.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...n})});d.displayName=i.VY.displayName}},function(e){e.O(0,[441,681,582,447,624,263,918,883,886,971,117,744],function(){return e(e.s=36343)}),_N_E=e.O()}]);