(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[798],{30519:function(e,n,t){Promise.resolve().then(t.bind(t,31018))},31018:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var a=t(57437),s=t(2265),r=t(59883),c=t(62869),l=t(95186),i=t(73247),o=t(99397),d=t(15868),m=t(18930),x=t(73578),h=t(26110),u=t(98339),f=t(71264),b=t(77992);let j=[{id:1,name:"Коллекция Феникс"},{id:2,name:"Коллекция Кобра"},{id:3,name:"Коллекция Охотник"},{id:4,name:"Коллекция Перчатки"},{id:5,name:"Коллекция Хрома"}];function p(){let{toast:e}=(0,b.pm)(),[n,t]=(0,s.useState)([]),[p,N]=(0,s.useState)(!0),[g,v]=(0,s.useState)(""),[z,y]=(0,s.useState)(!1),[w,C]=(0,s.useState)(!1),[S,E]=(0,s.useState)(!1),[k,Z]=(0,s.useState)(!1),[T,R]=(0,s.useState)(null),O=async()=>{try{N(!0),y(!1);let e=await fetch("/api/collections",{cache:"no-store"});if(!e.ok)throw Error("API Error: ".concat(e.status));let n=await e.json();t(n)}catch(n){console.error("Error fetching collections:",n),t(j),y(!0),e({title:"Внимание",description:"Используются демо-данные для предпросмотра.",variant:"destructive"})}finally{N(!1)}};(0,s.useEffect)(()=>{O()},[]);let A=n.filter(e=>e.name.toLowerCase().includes(g.toLowerCase()));return(0,a.jsxs)(r.default,{children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Collections"}),(0,a.jsx)("p",{className:"text-zinc-400",children:"Manage item collections"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(i.Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-zinc-500"}),(0,a.jsx)(l.I,{type:"search",placeholder:"Search collections...",className:"pl-8 bg-zinc-900 border-zinc-800 focus-visible:ring-zinc-700",value:g,onChange:e=>v(e.target.value)})]}),(0,a.jsxs)(c.z,{className:"bg-zinc-800 hover:bg-zinc-700",onClick:()=>C(!0),children:[(0,a.jsx)(o.Z,{size:18,className:"mr-2"}),"Add Collection"]})]})]}),p&&(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-zinc-400"})}),z&&!p&&(0,a.jsxs)("div",{className:"bg-amber-900/20 border border-amber-800 text-amber-300 p-4 rounded-lg mb-6",children:[(0,a.jsx)("p",{children:"Используются демо-данные для предпросмотра."}),(0,a.jsx)("p",{className:"mt-2 text-sm",children:"В рабочей версии приложения данные будут загружаться с вашего API."})]}),!p&&(0,a.jsxs)(a.Fragment,{children:[g&&(0,a.jsxs)("p",{className:"mb-4 text-zinc-400",children:["Найдено результатов: ",A.length]}),(0,a.jsx)("div",{className:"rounded-md border border-zinc-800 overflow-hidden",children:(0,a.jsxs)(x.iA,{children:[(0,a.jsx)(x.xD,{className:"bg-zinc-900",children:(0,a.jsxs)(x.SC,{className:"hover:bg-zinc-900/80 border-zinc-800",children:[(0,a.jsx)(x.ss,{className:"text-zinc-400",children:"ID"}),(0,a.jsx)(x.ss,{className:"text-zinc-400",children:"Name"}),(0,a.jsx)(x.ss,{className:"text-zinc-400 text-right",children:"Actions"})]})}),(0,a.jsx)(x.RM,{children:A.length>0?A.map(e=>(0,a.jsxs)(x.SC,{className:"hover:bg-zinc-900/50 border-zinc-800",children:[(0,a.jsx)(x.pj,{children:e.id}),(0,a.jsx)(x.pj,{className:"font-medium",children:e.name}),(0,a.jsx)(x.pj,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>{R(e),E(!0)},className:"h-8 w-8 text-zinc-400 hover:text-zinc-100",children:(0,a.jsx)(d.Z,{size:16})}),(0,a.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>{R(e),Z(!0)},className:"h-8 w-8 text-red-400 hover:text-red-300",children:(0,a.jsx)(m.Z,{size:16})})]})})]},e.id)):(0,a.jsx)(x.SC,{children:(0,a.jsx)(x.pj,{colSpan:3,className:"h-24 text-center",children:g?"Ничего не найдено по вашему запросу":"Коллекции не найдены"})})})]})})]}),(0,a.jsx)(h.Vq,{open:w,onOpenChange:C,children:(0,a.jsxs)(h.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-2xl",children:[(0,a.jsx)(h.fK,{children:(0,a.jsx)(h.$N,{children:"Добавить новую коллекцию"})}),(0,a.jsx)(u.Z,{endpoint:"/api/collections",entityName:"Коллекция",fields:[{name:"name",label:"Название",type:"text",required:!0}],onSuccess:()=>{C(!1),O()},onCancel:()=>C(!1)})]})}),(0,a.jsx)(h.Vq,{open:S,onOpenChange:E,children:(0,a.jsxs)(h.cZ,{className:"bg-zinc-900 border-zinc-800 text-zinc-100 max-w-2xl",children:[(0,a.jsx)(h.fK,{children:(0,a.jsx)(h.$N,{children:"Редактировать коллекцию"})}),T&&(0,a.jsx)(u.Z,{endpoint:"/api/collections",entityName:"Коллекция",initialData:T,fields:[{name:"name",label:"Название",type:"text",required:!0}],onSuccess:()=>{E(!1),O()},onCancel:()=>E(!1)})]})}),T&&(0,a.jsx)(f.Z,{isOpen:k,onClose:()=>Z(!1),onConfirm:()=>{Z(!1),O()},endpoint:"/api/collections",id:T.id,entityName:"коллекцию",entityLabel:T.name})]})}},71264:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var a=t(57437),s=t(2265),r=t(37099),c=t(77992),l=t(51817);function i(e){let{isOpen:n,onClose:t,onConfirm:i,endpoint:o,id:d,entityName:m,entityLabel:x}=e,[h,u]=(0,s.useState)(!1),f=async()=>{u(!0);try{if(!(await fetch("".concat(o,"/").concat(d),{method:"DELETE"})).ok)throw Error("Ошибка при удалении ".concat(m));(0,c.Am)({title:"Успешно",description:"".concat(x," был удален")}),i()}catch(e){console.error("Error deleting ".concat(m,":"),e),(0,c.Am)({title:"Ошибка",description:"Не удалось удалить ".concat(m),variant:"destructive"}),t()}finally{u(!1)}};return(0,a.jsx)(r.aR,{open:n,onOpenChange:t,children:(0,a.jsxs)(r._T,{className:"bg-zinc-900 border-zinc-800",children:[(0,a.jsxs)(r.fY,{children:[(0,a.jsx)(r.f$,{children:"Вы уверены?"}),(0,a.jsxs)(r.yT,{className:"text-zinc-400",children:["Вы собираетесь удалить ",m,' "',x,'". Это действие нельзя отменить.']})]}),(0,a.jsxs)(r.xo,{children:[(0,a.jsx)(r.le,{className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700 text-zinc-300",disabled:h,children:"Отмена"}),(0,a.jsx)(r.OL,{onClick:e=>{e.preventDefault(),f()},className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",disabled:h,children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Удаление..."]}):"Удалить"})]})]})})}},98339:function(e,n,t){"use strict";t.d(n,{Z:function(){return h}});var a=t(57437),s=t(2265),r=t(62869),c=t(95186),l=t(26815),i=t(77992),o=t(49322),d=t(51817),m=t(53647),x=t(65613);function h(e){let{endpoint:n,entityName:t,initialData:h,fields:u,onSuccess:f,onCancel:b}=e,j=!!(null==h?void 0:h.id),[p,N]=(0,s.useState)(!1),[g,v]=(0,s.useState)(null),[z,y]=(0,s.useState)(()=>{let e={};return u.forEach(n=>{h&&void 0!==h[n.name]?e[n.name]=h[n.name]:void 0!==n.defaultValue?e[n.name]=n.defaultValue:(n.type,e[n.name]="")}),e}),w=(e,n)=>{y(t=>({...t,[e]:n})),v(null)},C=async e=>{e.preventDefault(),N(!0),v(null);try{let e={...z};u.forEach(n=>{"select"===n.type&&e[n.name]&&(e[n.name]=Number(e[n.name]))});let a=j?"".concat(n,"/").concat(h.id):n,s=await fetch(a,{method:j?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();if(!s.ok){if(400===s.status||422===s.status){let e=r.error||r.message||r.detail||"Неверные данные",n="";throw r.details&&(n="object"==typeof r.details?JSON.stringify(r.details,null,2):r.details),Error("".concat(e).concat(n?"\n".concat(n):""))}throw Error(r.error||"Произошла ошибка при сохранении")}(0,i.Am)({title:"Успешно",description:j?"".concat(t," обновлен"):"".concat(t," создан")}),f()}catch(e){console.error("Error saving ".concat(t,":"),e),v(e instanceof Error?e.message:"Произошла ошибка при сохранении")}finally{N(!1)}};return(0,a.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[g&&(0,a.jsxs)(x.bZ,{variant:"destructive",className:"bg-red-900/20 border-red-800 text-red-300",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4"}),(0,a.jsx)(x.X,{className:"whitespace-pre-wrap",children:g})]}),u.map(e=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(l.Label,{htmlFor:e.name,children:e.label}),"text"===e.type&&(0,a.jsx)(c.I,{id:e.name,value:z[e.name]||"",onChange:n=>w(e.name,n.target.value),className:"bg-zinc-800 border-zinc-700",required:e.required}),"color"===e.type&&(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.I,{id:e.name,type:"color",value:z[e.name]||"#000000",onChange:n=>w(e.name,n.target.value),className:"w-16 p-1 h-10 bg-zinc-800 border-zinc-700",required:e.required}),(0,a.jsx)(c.I,{value:z[e.name]||"",onChange:n=>w(e.name,n.target.value),className:"flex-1 font-mono bg-zinc-800 border-zinc-700",placeholder:"#000000"})]}),"select"===e.type&&e.options&&(0,a.jsxs)(m.Ph,{value:String(z[e.name]||""),onValueChange:n=>w(e.name,n?Number(n):""),children:[(0,a.jsx)(m.i4,{className:"bg-zinc-800 border-zinc-700",children:(0,a.jsx)(m.ki,{placeholder:"Не выбрано"})}),(0,a.jsx)(m.Bw,{className:"bg-zinc-900 border-zinc-700",children:e.options.map(e=>(0,a.jsx)(m.Ql,{value:String(e.id),children:e.name},e.id))})]})]},e.name)),(0,a.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,a.jsx)(r.z,{type:"button",variant:"outline",onClick:b,className:"bg-zinc-800 border-zinc-700 hover:bg-zinc-700",children:"Отмена"}),(0,a.jsxs)(r.z,{type:"submit",disabled:p,className:"bg-zinc-700 hover:bg-zinc-600",children:[p&&(0,a.jsx)(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}),j?"Сохранить":"Создать"]})]})]})}},73578:function(e,n,t){"use strict";t.d(n,{RM:function(){return i},SC:function(){return o},iA:function(){return c},pj:function(){return m},ss:function(){return d},xD:function(){return l}});var a=t(57437),s=t(2265),r=t(94508);let c=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:n,className:(0,r.cn)("w-full caption-bottom text-sm",t),...s})})});c.displayName="Table";let l=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:n,className:(0,r.cn)("[&_tr]:border-b",t),...s})});l.displayName="TableHeader";let i=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:n,className:(0,r.cn)("[&_tr:last-child]:border-0",t),...s})});i.displayName="TableBody",s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:n,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let o=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:n,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});o.displayName="TableRow";let d=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:n,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});d.displayName="TableHead";let m=s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:n,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});m.displayName="TableCell",s.forwardRef((e,n)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:n,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"}},function(e){e.O(0,[441,681,582,447,624,263,883,886,971,117,744],function(){return e(e.s=30519)}),_N_E=e.O()}]);